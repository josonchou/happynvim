const ie={context:void 0,registry:void 0},oe=(e,t)=>e===t,N=Symbol("solid-proxy"),ce=Symbol("solid-track"),xe=Symbol("solid-dev-component"),_={equals:oe};let X=te;const S=1,U=2,H={owned:null,cleanups:null,context:null,owner:null};var h=null;let K=null,f=null,g=null,v=null,F=0;function R(e,t){const n=f,r=h,s=e.length===0,u=s?H:{owned:null,cleanups:null,context:null,owner:t===void 0?r:t},l=s?e:()=>e(()=>m(()=>T(u)));h=u,f=null;try{return j(l,!0)}finally{f=n,h=r}}function z(e,t){t=t?Object.assign({},_,t):_;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=s=>(typeof s=="function"&&(s=s(n.value)),ee(n,s));return[Z.bind(n),r]}function ae(e,t,n){const r=Y(e,t,!1,S);k(r)}function Ce(e,t,n){X=ge;const r=Y(e,t,!1,S);(!n||!n.render)&&(r.user=!0),v?v.push(r):k(r)}function O(e,t,n){n=n?Object.assign({},_,n):_;const r=Y(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,k(r),Z.bind(r)}function m(e){if(f===null)return e();const t=f;f=null;try{return e()}finally{f=t}}function Oe(e,t,n){const r=Array.isArray(e);let s,u=n&&n.defer;return l=>{let o;if(r){o=Array(e.length);for(let a=0;a<e.length;a++)o[a]=e[a]()}else o=e();if(u){u=!1;return}const c=m(()=>t(o,s,l));return s=o,c}}function J(e){return h===null||(h.cleanups===null?h.cleanups=[e]:h.cleanups.push(e)),e}function Pe(e,t){const n=Symbol("context");return{id:n,Provider:be(n),defaultValue:e}}function Ee(e){let t;return(t=se(h,e.id))!==void 0?t:e.defaultValue}function fe(e){const t=O(e),n=O(()=>G(t()));return n.toArray=()=>{const r=n();return Array.isArray(r)?r:r!=null?[r]:[]},n}function Z(){if(this.sources&&this.state)if(this.state===S)k(this);else{const e=g;g=null,j(()=>M(this),!1),g=e}if(f){const e=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(e)):(f.sources=[this],f.sourceSlots=[e]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function ee(e,t,n){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&j(()=>{for(let s=0;s<e.observers.length;s+=1){const u=e.observers[s],l=K&&K.running;l&&K.disposed.has(u),(l?!u.tState:!u.state)&&(u.pure?g.push(u):v.push(u),u.observers&&ne(u)),l||(u.state=S)}if(g.length>1e6)throw g=[],new Error},!1)),t}function k(e){if(!e.fn)return;T(e);const t=h,n=f,r=F;f=h=e,he(e,e.value,r),f=n,h=t}function he(e,t,n){let r;try{r=e.fn(t)}catch(s){return e.pure&&(e.state=S,e.owned&&e.owned.forEach(T),e.owned=null),e.updatedAt=n+1,re(s)}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?ee(e,r):e.value=r,e.updatedAt=n)}function Y(e,t,n,r=S,s){const u={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:h,context:null,pure:n};return h===null||h!==H&&(h.owned?h.owned.push(u):h.owned=[u]),u}function $(e){if(e.state===0)return;if(e.state===U)return M(e);if(e.suspense&&m(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<F);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===S)k(e);else if(e.state===U){const r=g;g=null,j(()=>M(e,t[0]),!1),g=r}}function j(e,t){if(g)return e();let n=!1;t||(g=[]),v?n=!0:v=[],F++;try{const r=e();return de(n),r}catch(r){n||(v=null),g=null,re(r)}}function de(e){if(g&&(te(g),g=null),e)return;const t=v;v=null,t.length&&j(()=>X(t),!1)}function te(e){for(let t=0;t<e.length;t++)$(e[t])}function ge(e){let t,n=0;for(t=0;t<e.length;t++){const r=e[t];r.user?e[n++]=r:$(r)}for(t=0;t<n;t++)$(e[t])}function M(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const r=e.sources[n];if(r.sources){const s=r.state;s===S?r!==t&&(!r.updatedAt||r.updatedAt<F)&&$(r):s===U&&M(r,t)}}}function ne(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=U,n.pure?g.push(n):v.push(n),n.observers&&ne(n))}}function T(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),r=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const u=s.pop(),l=n.observerSlots.pop();r<s.length&&(u.sourceSlots[l]=r,s[r]=u,n.observerSlots[r]=l)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)T(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function pe(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function re(e,t=h){throw pe(e)}function se(e,t){return e?e.context&&e.context[t]!==void 0?e.context[t]:se(e.owner,t):void 0}function G(e){if(typeof e=="function"&&!e.length)return G(e());if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++){const r=G(e[n]);Array.isArray(r)?t.push.apply(t,r):t.push(r)}return t}return e}function be(e,t){return function(r){let s;return ae(()=>s=m(()=>(h.context={[e]:r.value},fe(()=>r.children))),void 0),s}}const we=Symbol("fallback");function B(e){for(let t=0;t<e.length;t++)e[t]()}function ye(e,t,n={}){let r=[],s=[],u=[],l=0,o=t.length>1?[]:null;return J(()=>B(u)),()=>{let c=e()||[],a,i;return c[ce],m(()=>{let d=c.length,A,P,E,L,D,b,w,y,x;if(d===0)l!==0&&(B(u),u=[],r=[],s=[],l=0,o&&(o=[])),n.fallback&&(r=[we],s[0]=R(le=>(u[0]=le,n.fallback())),l=1);else if(l===0){for(s=new Array(d),i=0;i<d;i++)r[i]=c[i],s[i]=R(p);l=d}else{for(E=new Array(d),L=new Array(d),o&&(D=new Array(d)),b=0,w=Math.min(l,d);b<w&&r[b]===c[b];b++);for(w=l-1,y=d-1;w>=b&&y>=b&&r[w]===c[y];w--,y--)E[y]=s[w],L[y]=u[w],o&&(D[y]=o[w]);for(A=new Map,P=new Array(y+1),i=y;i>=b;i--)x=c[i],a=A.get(x),P[i]=a===void 0?-1:a,A.set(x,i);for(a=b;a<=w;a++)x=r[a],i=A.get(x),i!==void 0&&i!==-1?(E[i]=s[a],L[i]=u[a],o&&(D[i]=o[a]),i=P[i],A.set(x,i)):u[a]();for(i=b;i<d;i++)i in E?(s[i]=E[i],u[i]=L[i],o&&(o[i]=D[i],o[i](i))):s[i]=R(p);s=s.slice(0,l=d),r=c.slice(0)}return s});function p(d){if(u[i]=d,o){const[A,P]=z(i);return o[i]=P,t(c[i],A)}return t(c[i])}}}function ke(e,t){return m(()=>e(t||{}))}function I(){return!0}const W={get(e,t,n){return t===N?n:e.get(t)},has(e,t){return t===N?!0:e.has(t)},set:I,deleteProperty:I,getOwnPropertyDescriptor(e,t){return{configurable:!0,enumerable:!0,get(){return e.get(t)},set:I,deleteProperty:I}},ownKeys(e){return e.keys()}};function q(e){return(e=typeof e=="function"?e():e)?e:{}}function ve(){for(let e=0,t=this.length;e<t;++e){const n=this[e]();if(n!==void 0)return n}}function je(...e){let t=!1;for(let u=0;u<e.length;u++){const l=e[u];t=t||!!l&&N in l,e[u]=typeof l=="function"?(t=!0,O(l)):l}if(t)return new Proxy({get(u){for(let l=e.length-1;l>=0;l--){const o=q(e[l])[u];if(o!==void 0)return o}},has(u){for(let l=e.length-1;l>=0;l--)if(u in q(e[l]))return!0;return!1},keys(){const u=[];for(let l=0;l<e.length;l++)u.push(...Object.keys(q(e[l])));return[...new Set(u)]}},W);const n={},r={},s=new Set;for(let u=e.length-1;u>=0;u--){const l=e[u];if(!l)continue;const o=Object.getOwnPropertyNames(l);for(let c=0,a=o.length;c<a;c++){const i=o[c];if(i==="__proto__"||i==="constructor")continue;const p=Object.getOwnPropertyDescriptor(l,i);if(!s.has(i))p.get?(s.add(i),Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:ve.bind(r[i]=[p.get.bind(l)])})):(p.value!==void 0&&s.add(i),n[i]=p.value);else{const d=r[i];d?p.get?d.push(p.get.bind(l)):p.value!==void 0&&d.push(()=>p.value):n[i]===void 0&&(n[i]=p.value)}}}return n}function Le(e,...t){if(N in e){const s=new Set(t.length>1?t.flat():t[0]),u=t.map(l=>new Proxy({get(o){return l.includes(o)?e[o]:void 0},has(o){return l.includes(o)&&o in e},keys(){return l.filter(o=>o in e)}},W));return u.push(new Proxy({get(l){return s.has(l)?void 0:e[l]},has(l){return s.has(l)?!1:l in e},keys(){return Object.keys(e).filter(l=>!s.has(l))}},W)),u}const n={},r=t.map(()=>({}));for(const s of Object.getOwnPropertyNames(e)){const u=Object.getOwnPropertyDescriptor(e,s),l=!u.get&&!u.set&&u.enumerable&&u.writable&&u.configurable;let o=!1,c=0;for(const a of t)a.includes(s)&&(o=!0,l?r[c][s]=u.value:Object.defineProperty(r[c],s,u)),++c;o||(l?n[s]=u.value:Object.defineProperty(n,s,u))}return[...r,n]}let me=0;function De(){const e=ie.context;return e?`${e.id}${e.count++}`:`cl-${me++}`}const Se=e=>`Stale read from <${e}>.`;function Ie(e){const t="fallback"in e&&{fallback:()=>e.fallback};return O(ye(()=>e.each,e.children,t||void 0))}function Ne(e){const t=e.keyed,n=O(()=>e.when,void 0,{equals:(r,s)=>t?r===s:!r==!s});return O(()=>{const r=n();if(r){const s=e.children;return typeof s=="function"&&s.length>0?m(()=>s(t?r:()=>{if(!m(n))throw Se("Show");return e.when})):s}return e.fallback},void 0,void 0)}const C=chrome.storage.local,Ae=(e,t)=>{const[n,r]=z(t),[s,u]=z(!1);C.get(e).then(c=>{r(c[e]??t),u(!0)});const l=c=>{const a=c[e];a!=null&&a.newValue&&r(a.newValue)};return C.onChanged.addListener(l),J(()=>{C.onChanged.removeListener(l)}),{config:n,updateConfig:async c=>{await C.set({[e]:c})},initialized:s}},V="config",ue=()=>({csp_http_disabled:!1,csp_html_disabled:!1}),_e=()=>Ae(V,ue()),Ue=async()=>(await C.get(V))[V]??ue(),Q=new WeakMap,$e=e=>{if(Q.has(e))return;const t=n=>{const r=n[V];r&&e(r.newValue,r.oldValue)};Q.set(e,t),C.onChanged.addListener(t)};export{xe as $,Ie as F,Ne as S,$e as a,ae as b,R as c,O as d,N as e,z as f,Ue as g,Ce as h,J as i,De as j,Pe as k,Ee as l,je as m,ke as n,Oe as o,fe as p,_e as q,Le as s,m as u};
